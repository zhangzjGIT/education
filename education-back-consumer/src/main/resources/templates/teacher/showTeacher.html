<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>教师审核</title>
    <link rel="stylesheet" href="/layui/css/layui.css" media="all">

</head>
<body>

<table class="layui-hide" id="demo" lay-filter="test"></table>


<div class="layui-tab-item">
    <div id="pageDemo"></div>
</div>

<script src="/layui/layui.js"></script>
<script src="../layui/lay/modules/laypage.js"></script>
<script>

    layui.use(['laydate', 'laypage', 'layer', 'table', 'carousel', 'upload', 'element', 'slider'], function(){
        var laydate = layui.laydate //日期
            ,laypage = layui.laypage //分页
            ,layer = layui.layer //弹层
            ,table = layui.table //表格
            ,carousel = layui.carousel //轮播
            ,upload = layui.upload //上传
            ,element = layui.element //元素操作
            ,slider = layui.slider //滑块

        //第一个实例
        table.render({
            elem: '#demo'
            ,height: 500
            ,url: '/user/queryTeacher' //数据接口
            ,method:'post'
            ,page: true //开启分页
           // ,toolbar: 'default' //开启工具栏，此处显示默认图标，可以自定义模板，详见文档
            ,totalRow: true //开启合计行

            ,cols: [
                [ //表头
                    {field: 'teacherId', title: 'ID',  sort: true, fixed: 'left'}
                    ,{field: 'teacherName', title: '教师姓名' }
                    ,{field: 'createTime', title: '创建时间', width: 200,templet: "<div>{{layui.util.toDateString(d.createTime, 'yyyy-MM-dd HH:mm:ss')}}</div>"}
                    ,{field :'status'  , title :'审批状态' , minWidth : 100, templet : '#switchNullTpl', unresize : true}

                ]
            ],

        });

//分页
        laypage.render({
            elem:'pageDemo'
            ,count:'count'
            ,curr:'page'
            ,limit:'limit'
            ,layout: ['prev', 'page', 'next', 'skip','count','limit']
            ,jump:function (obj,first) {
                if(!first){
                    curnum = obj.curr;
                    limitcount = obj.limit;
                    //console.log("curnum"+curnum);
                    //console.log("limitcount"+limitcount);
                    //layer.msg(curnum+"-"+limitcount);
                    productsearch(productGroupId,curnum,limitcount);
                }
            }
        })


    });


//审核按钮
    layui.use(['layer','form'], function () {
        var $ = layui.jquery
            , upload = layui.upload
            , form = layui.form
            , layer = layui.layer;

        form.on('switch(switchTest)', function(obj){
            // 获取当前控件
            var status_id = obj.value;
              //  alert("状态值："+status_id);
            var data = $(obj.elem);
            //遍历父级tr，取第一个，然后查找第二个td，取值
            var id = data.parents('tr').first().find('td').eq(0).text();
            // 获取当前所在行的索引
          //  alert("当前Id值："+id);
            $.ajax({
                url: "/user/updStatus",
                type: "post",
                dataType: "JSON",
                data: {status: status_id, teacherId: id},
                success: function () {

                        layer.msg("修改成功！！！");
                        location.reload();
                },
                error:function(){
                    layer.msg("修改失败！！！");
                }
            });
        });
    });

</script>
<script id="switchNullTpl" type="text/html">
    <input type="checkbox" name="status"  value="{{d.status}}" lay-skin="switch" lay-text="√|×" lay-filter="switchTest" {{ d.status == 1 ? 'checked' : '' }}>
</script>



</body>
</html>